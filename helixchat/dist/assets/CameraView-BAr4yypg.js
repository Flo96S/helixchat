import{a as c}from"./axios-B4uVmeYG.js";import{d,_ as u,o as i,c as a,a as o,k as l}from"./index-LACCAfl5.js";const m=d({name:"Camera",data(){return{cameraVisible:!0,cameraActive:!1,photoTaken:!1}},props:{},mounted:function(){this.RequireCamera()},methods:{async ConfirmPhoto(){let e=null,t=document.getElementById("takenphoto");try{if((await c.post("https://www2.hs-esslingen.de/~melcher/map/chat/api/",{token:localStorage.getItem("token")||sessionStorage.getItem("token"),text:e,request:"postmessage",chatid:0,photo:t.src},{headers:{"Content-Type":"application/json"}})).status!=200){alert("Error sending image");return}}catch{alert("Error sending image");return}this.ToMain()},DenyPhoto(){console.log("Deny");const e=document.getElementById("takenphoto");e.src="",this.cameraVisible=!0,this.photoTaken=!1,this.RequireCamera()},DrawImage(){const e=document.createElement("canvas"),t=e.getContext("2d"),n=document.querySelector("video");if(n==null||(e.width=n.videoWidth,e.height=n.videoHeight,t==null))return;t.drawImage(n,0,0,e.width,e.height);const r=document.getElementById("takenphoto");if(r==null){alert("Error while taking an image");return}r.src=e.toDataURL("image/png"),this.SwitchOff(),this.photoTaken=!0},SwitchOff(){const e=document.querySelector("video");e!=null&&(e.srcObject=null,this.cameraActive=!1,this.cameraVisible=!1)},RequireCamera(){this.cameraActive||navigator.mediaDevices.getUserMedia&&(this.cameraActive=!0,navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){var t=document.querySelector("video");t!=null&&(t.srcObject=e,t.onloadedmetadata=function(n){t!=null&&t.play()})}).catch(function(e){console.log("Something went wrong!"),console.log(e)}))},HandleSendingImage(){console.log("")},ToMain(){this.SwitchOff(),this.$router.replace("/messages")}}}),h={class:"h-12 bg-blue-500 items-center flex"},f={key:0},g=o("video",{class:"rounded-xl w-11/12 object-cover bg-black mt-2 mx-auto"},null,-1),p=[g],v=o("div",{class:"mt-2 px-2"},[o("img",{id:"takenphoto",class:"rounded-xl"}),o("p",null,[o("img")])],-1),w={key:1,class:"absolute bottom-4 w-full"},k=o("div",{class:"text-center mb-4"}," Are you sure you want to post this image? ",-1),y={class:"flex px-4 w-full justify-between"},b={key:2,class:"absolute bottom-4 flex px-4 w-full justify-between"};function x(e,t,n,r,C,D){return i(),a("div",null,[o("div",h,[o("p",{class:"text-white text-xl cursor-pointer icon-left-open",onClick:t[0]||(t[0]=()=>e.ToMain())},"Camera")]),e.cameraVisible?(i(),a("div",f,p)):l("",!0),v,e.photoTaken?(i(),a("div",w,[k,o("div",y,[o("div",{onClick:t[1]||(t[1]=(...s)=>e.DenyPhoto&&e.DenyPhoto(...s)),class:"bg-red-700 h-20 w-20 rounded-full items-center justify-center flex icon-cancel text-4xl cursor-pointer"}),o("div",{onClick:t[2]||(t[2]=(...s)=>e.ConfirmPhoto&&e.ConfirmPhoto(...s)),class:"bg-green-700 h-20 w-20 rounded-full items-center justify-center flex icon-ok text-4xl cursor-pointer"})])])):l("",!0),e.photoTaken?l("",!0):(i(),a("div",b,[o("div",{onClick:t[3]||(t[3]=(...s)=>e.DrawImage&&e.DrawImage(...s)),class:"bg-slate-300 h-20 mx-auto w-20 text-black rounded-full items-center justify-center flex icon-camera text-3xl cursor-pointer"})]))])}const j=u(m,[["render",x]]);export{j as default};
